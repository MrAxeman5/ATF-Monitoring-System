<!DOCTYPE html>
<html>
<head>
    <title>Player Data</title>
    <link rel="stylesheet" type="text/css" href="styles/style.css">
</head>
<body>
    <h1>Player Data</h1>
    <table>
        <thead>
            <tr>
                <th>Player Name</th>
                <th>X Position</th>
                <th>Y Position</th>
                <th>Z Position</th>
            </tr>
        </thead>
        <tbody id="player-table-body">
            <!-- Table body content will be dynamically generated here -->
        </tbody>
    </table>

    <p id="last-update">Last Update: </p>

    <script>
        function updateTable() {
            fetch('/api/fetch-data-map') // Fetch player data from the server
                .then(response => response.json())
                .then(data => {
                    const tableBody = document.getElementById('player-table-body');
                    tableBody.innerHTML = ''; // Clear existing table rows

                    data.players.forEach(player => {
                        // Clean the player's name by removing '>' character
                        const cleanedName = player.name.replace('>', '');
                        const row = document.createElement('tr');
                        row.innerHTML = `
                            <td>${cleanedName}</td>
                            <td>${player.position ? player.position.x : 'N/A'}</td>
                            <td>${player.position ? player.position.y : 'N/A'}</td>
                            <td>${player.position ? player.position.z : 'N/A'}</td>
                        `;
                        tableBody.appendChild(row);
                    });

                    // Update the last update timestamp
                    const lastUpdate = document.getElementById('last-update');
                    lastUpdate.textContent = 'Last Update: ' + new Date().toLocaleTimeString();
                })
                .catch(error => {
                    console.error('Error updating table:', error);
                });
        }

        // Initial update and periodic updates every 10 seconds
        updateTable();
        setInterval(updateTable, 10000);
    </script>
</body>
</html>
